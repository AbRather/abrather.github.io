<section id="career" class="career">
    <div class="container" data-aos="fade-up">
        
        <div class="section-title">
            <h2><span data-i18n="career.my_career">CAREER</span></h2>
        </div>

        <!-- Tab Navigation -->
        <ul class="nav nav-tabs career-tabs" role="tablist">
            <li role="presentation" class="active">
                <a data-toggle="tab" href="#professional" role="tab">
                    <span data-i18n="career.professional">Professional Experience</span>
                </a>
            </li>
            <li role="presentation">
                <a data-toggle="tab" href="#education" role="tab">
                    <span data-i18n="career.education">Education</span>
                </a>
            </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content">
            <!-- Professional Experience Tab -->
            <div class="tab-pane fade show active" id="professional" role="tabpanel">
                <div class="row features-block">
                    <div class="col-lg-12">
                        <div id="vertical-timeline" class="vertical-container light-timeline center-orientation">
                        {% for career in site.data.careers %}
                        {% assign loopindex = forloop.index | modulo: 2 %}
                            <div class="vertical-timeline-block">
                                <div class="vertical-timeline-icon navy-bg wow rotateIn">
                                    <i class="fa {{ career.icon }}"></i>
                                </div>
                                <div class="vertical-timeline-content wow {% if loopindex == 1 %} rotateInUpRight {% else %} rotateInUpLeft {% endif %}">
                                    <h2><span data-i18n="career.{{ career.name.i18n }}">{{ career.name.detail }}</span></h2>
                                    {% if career.desc.details %}
                                        {% for item in career.desc.details %}
                                            <p>{{ item }}</p>
                                        {% endfor %}
                                    {% else %}
                                        <p><span data-i18n="career.{{ career.desc.i18n }}">{{ career.desc.detail }} </span></p>
                                    {% endif %}
                                    <span class="vertical-date"><span data-i18n="career.{{ career.date.i18n }}"> {{ career.date.detail }} </span>
                                    <br/> <small><span data-i18n="career.{{ career.job.i18n }}">{{ career.job.detail }}</span></small> </span>
                                </div>
                            </div>
                        {% endfor %}
                        </div>
                    </div>
                </div>
            </div>

            <!-- Education Tab -->
            <div class="tab-pane fade" id="education" role="tabpanel">
                <div class="row features-block">
                    <div class="col-lg-12">
                        <div id="education-timeline" class="vertical-container light-timeline center-orientation">
                        {% for edu in site.data.education %}
                        {% assign loopindex = forloop.index | modulo: 2 %}
                            <div class="vertical-timeline-block">
                                <div class="vertical-timeline-icon navy-bg wow rotateIn">
                                    <i class="fa {{ edu.icon }}"></i>
                                </div>
                                <div class="vertical-timeline-content wow {% if loopindex == 1 %} rotateInUpRight {% else %} rotateInUpLeft {% endif %}">
                                    <h2>{{ edu.school }}</h2>
                                    <p>{{ edu.description }}</p>
                                    <span class="vertical-date"><span>{{ edu.date }}</span>
                                    <br/> <small>{{ edu.degree }}</small> </span>
                                </div>
                            </div>
                        {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const careerSection = document.getElementById('career');
    
    function animateTimelineBlocks(timelineId) {
        const timeline = document.getElementById(timelineId);
        if (!timeline) return;
        
        const blocks = timeline.querySelectorAll('.vertical-timeline-block');
        blocks.forEach((block, index) => {
            setTimeout(() => {
                block.classList.add('animate-in');
            }, index * 150); // Stagger animation by 150ms
        });
    }
    
    function resetTimelineBlocks(timelineId) {
        const timeline = document.getElementById(timelineId);
        if (!timeline) return;
        
        const blocks = timeline.querySelectorAll('.vertical-timeline-block');
        blocks.forEach(block => {
            block.classList.remove('animate-in');
        });
    }
    
    // Animate on scroll into view
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                // Check which tab is active and animate that timeline
                const professionalTab = document.getElementById('professional');
                const educationTab = document.getElementById('education');
                
                if (professionalTab && professionalTab.classList.contains('active')) {
                    resetTimelineBlocks('vertical-timeline');
                    setTimeout(() => animateTimelineBlocks('vertical-timeline'), 50);
                } else if (educationTab && educationTab.classList.contains('active')) {
                    resetTimelineBlocks('education-timeline');
                    setTimeout(() => animateTimelineBlocks('education-timeline'), 50);
                }
            } else {
                // Reset when leaving viewport
                resetTimelineBlocks('vertical-timeline');
                resetTimelineBlocks('education-timeline');
            }
        });
    }, { threshold: 0.2 });
    
    if (careerSection) {
        observer.observe(careerSection);
    }
    
    // Animate when switching tabs
    const tabs = document.querySelectorAll('.career-tabs a[data-toggle="tab"]');
    tabs.forEach(tab => {
        tab.addEventListener('shown.bs.tab', function(e) {
            const target = e.target.getAttribute('href');
            if (target === '#professional') {
                resetTimelineBlocks('vertical-timeline');
                setTimeout(() => animateTimelineBlocks('vertical-timeline'), 50);
            } else if (target === '#education') {
                resetTimelineBlocks('education-timeline');
                setTimeout(() => animateTimelineBlocks('education-timeline'), 50);
            }
        });
    });
});
</script>
